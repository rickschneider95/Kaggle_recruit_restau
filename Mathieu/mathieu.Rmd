---
title: "Mathieu"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(lubridate)
library(timeDate)

```

```{r, warning=FALSE}
visit_air <- read_csv("data/air_visit_data.csv")
visit_air %>% glimpse()
visit_air %>% distinct(air_store_id) %>% nrow()
c(min(visit_air$visit_date),max(visit_air$visit_date)) 


visit_air2 <- read_csv("data/air_reserve.csv")
visit_air2 %>% glimpse()
visit_air2 %>% distinct(air_store_id) %>% nrow()
c(min(visit_air2$visit_datetime),max(visit_air2$visit_datetime)) 
visit_air2 <-visit_air2 %>% separate(visit_datetime, into = c('visit_date', 'visit_time'), sep = 10) %>% separate(reserve_datetime, into = c('reserve_date', 'reserve_time'), sep = 10)  


# From below we can conclude the data separate each reservation ( meaning one row correspond to one reservation per restaurant per day and not all the reservation per restaurant per day)
visit_air2 %>% filter(air_store_id=='air_877f79706adbfb06') %>% group_by(visit_date) %>% distinct(visit_date) %>% nrow() #get 259
visit_air2 %>% filter(air_store_id=='air_877f79706adbfb06') %>% group_by(visit_date) %>% nrow() #get 1061 

# From below we can conclude the data doesn't separate each visit ( meaning one row correspond to all visit  per restaurant per day)
visit_air %>% filter(air_store_id=='air_877f79706adbfb06') %>% group_by(visit_date) %>% distinct(visit_date) %>% nrow() #get 383
visit_air %>% filter(air_store_id=='air_877f79706adbfb06') %>% group_by(visit_date) %>% nrow() #get383 


# random test 
visit_air2 %>% filter(air_store_id=='air_877f79706adbfb06',visit_date=='2016-01-15') %>%summarise(total= sum(reserve_visitors)) #output 19
visit_air %>% filter(air_store_id=='air_877f79706adbfb06',visit_date=='2016-01-15') #output 19

visit_air2 %>% filter(air_store_id=='air_db80363d35f10926',visit_date=='2016-01-30') %>% summarise(total= sum(reserve_visitors)) #output 20
visit_air %>% filter(air_store_id=='air_db80363d35f10926',visit_date=='2016-01-30') #output 48

#how many stores in each data frame ? 
visit_air2  %>% nrow() #92378
visit_air2 %>% distinct(air_store_id) %>% nrow() #314
visit_air %>% distinct(air_store_id) %>% nrow() #829

```

```{r}
sample <- read_csv("data/sample_submission.csv")
head(sample)

store_id <- read_csv("data/store_id_relation.csv")
sample<- sample %>% separate(id,into = c('ID', 'date'), sep = 20) 
sample %>% distinct(ID) %>% nrow() #821

hpg_reserve <- read_csv("data/hpg_reserve.csv") 
hpg_reserve %>%  distinct(hpg_store_id) %>% nrow() #13325
```


